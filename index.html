<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <main>
      <form action="POST">
        <input type="text" />
        <button>View Result</button>
      </form>
    </main>
    <section class="result">
      <h1></h1>
      <h2></h2>
      <!-- 
      <h3 class="credits1">Credits: <bold></bold></h3>
      <h3 class="sgpa1">SGPA: <bold></bold></h3>
      <div>
        <h3>BEE Lab</h3>
        <h3>EC Lab</h3>
        <h3>ITW</h3>
        <h3>PPL</h3>
        <h3>BEE</h3>
        <h3>BEE</h3>
      </div> -->
    </section>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
      $(document).ready(function () {
        $(".result").hide();
        $('input[type="text"]').val("22Q91A6691").trigger("input");

        $('input[type="text"]').on("input", function () {
          $(this).val($(this).val().toUpperCase());
        });

        fetch("results.json")
          .then((response) => response.json())
          .then((data) => {
            const results = data;
            $("form").submit(function (e) {
              e.preventDefault();
              var rollNumber = $('input[type="text"]').val();
              const result = searchByRollNumber(rollNumber);
              console.log(result);

              $("main").hide();

              $(".result h1").text(result.data.Details["NAME"]);
              $(".result h2").text(result.data.Details["Roll_No"]);
              $(".result").show();
              const firstResult = result.data.Results["1-1"];
              console.log(firstResult);
              $.each(result.data.Results, function (semester, subjects) {
                // Create div for the semester
                var semesterDiv = $("<div>")
                  .attr("id", semester)
                  .appendTo("body");
                console.log(semester);
                // Create h1 for the semester
                $("<h1>").text(semester).appendTo(semesterDiv);
                typeof subjects === "string" &&
                  $("<h3>").text(subjects).appendTo(semesterDiv);
                var subjectDiv = $("<div>").appendTo(semesterDiv);

                $("<h3>").text(semester["Total"]).appendTo(subjectDiv);
                semester != "Total" &&
                  $("<h3>").text("Subject").appendTo(subjectDiv);
                semester != "Total" &&
                  $("<h3>").text("Total").appendTo(subjectDiv);
                semester != "Total" &&
                  $("<h3>").text("Grade").appendTo(subjectDiv);
                // Loop through each subject
                $.each(subjects, function (subjectId, subject) {
                  // Create div for the subject
                  var subjectDiv = $("<div>").appendTo(semesterDiv);
                  // Create h3 for subject name
                  $("<h3>").text(subject.subject_name).appendTo(subjectDiv);
                  // Create h3 for subject total
                  $("<h3>").text(subject.subject_total).appendTo(subjectDiv);
                  // Create h3 for subject grade
                  $("<h3>").text(subject.subject_grade).appendTo(subjectDiv);
                  (typeof subject === "number" || subjectId == "CGPA") &&
                    $("<h3>")
                      .text(subjectId + ": " + subject)
                      .appendTo(subjectDiv);
                });
              });
              //   $(".result .APL").text(firstResult['18101']['subject_total']);
              //   $(".result .APL.P").text(firstResult['18101']['subject_grade']);
              //   $(".result .ECSE").text(firstResult['18107']['subject_total']);
              //   $(".result .ECSE.P").text(firstResult['18107']['subject_grade']);
              //   $(".result .EW").text(firstResult['18114']['subject_total']);
              //   $(".result .EW.P").text(firstResult['18114']['subject_grade']);
              //   $(".result .ELCSL").text(firstResult['18115']['subject_total']);
              //   $(".result .ELCSL.P").text(firstResult['18115']['subject_grade']);
              //   $(".result .PPSL").text(firstResult['18117']['subject_total']);
              //   $(".result .PPSL.P").text(firstResult['18117']['subject_grade']);
              //   $(".result .ES").text(firstResult['18120']['subject_total']);
              //   $(".result .ES.P").text(firstResult['18120']['subject_grade']);
              //   $(".result .PPS").text(firstResult['181AP']['subject_total']);
              //   $(".result .PPS.P").text(firstResult['181AP']['subject_grade']);
              //   $(".result .M1").text(firstResult['181AN']['subject_total']);
              //   $(".result .M1.P").text(firstResult['181AN']['subject_grade']);
              //   $(".result .ESE").text(firstResult['181AK']['subject_total']);
              //   $(".result .ESE.P").text(firstResult['181AK']['subject_grade']);
              //   $(".result .AP").text(firstResult['181AA']['subject_total']);
              //   $(".result .AP.P").text(firstResult['181AA']['subject_grade']);
              //   $(".result .credits1 bold").text(firstResult['credits']);
              //   $(".result .sgpa1 bold").text(firstResult['CGPA']);
              //   $(".result").show();
            });

            function searchByRollNumber(rollNumberToFind) {
              const foundStudent = results.find(
                (student) => student.rollNumber === rollNumberToFind
              );
              return foundStudent ? foundStudent : "Student not found";
            }
          })
          .catch((error) => console.error("Error fetching data:", error));
      });
    </script>
  </body>
</html>
